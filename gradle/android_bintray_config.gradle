def BINTRAY_ORG = System.env.BINTRAY_ORG ?: ""
def BINTRAY_USER = System.env.BINTRAY_USER ?: ""
def BINTRAY_API_KEY = System.env.BINTRAY_API_KEY ?: ""

if (BINTRAY_ORG.isEmpty() || BINTRAY_USER.isEmpty() || BINTRAY_API_KEY.isEmpty()) {
  logger.warn("Missing one more Bintray release environment variables. Skipping setup.")
  return
}

apply plugin: "com.novoda.bintray-release"

if (versions == null || versions.publish_version == null) {
  throw new IllegalStateException("Unable to reference publish_version!")
} else if (module_group == null || module_name == null) {
  throw new IllegalStateException("Must provide module_group and module_name!")
}

logger.debug("Using Bintray user: $BINTRAY_USER")
publish {
  bintrayUser = BINTRAY_USER
  bintrayKey = BINTRAY_API_KEY
  userOrg = BINTRAY_ORG
  groupId = module_group
  artifactId = module_name
  publishVersion = versions.publish_version
  desc = "A template for Android library projects, with a sample."
  website = "https://github.com/afollestad/library-template-android"
  dryRun = false
}
